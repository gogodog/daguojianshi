<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dgjs.mapper.admin.OrganizationMapper">
  
  	<insert id="save" parameterType="organization" keyProperty="id" useGeneratedKeys="true">
	       insert into organization
	       (
               oname,
               summary,
               link,
               proxy,
               create_time,
               update_time
	       )
	       values
	       (
               #{oname},
               #{summary},
               #{link},
               #{proxy},
               now(),
               now()
	       )
	</insert>
	
	<select id="selectById" resultType="organization">
	      select id,oname,link,summary,proxy,create_time,update_time from organization where id=#{id}
	</select>
	
	<update id="update">
	      update organization
	         set 
	         <if test="oname!=null and oname!=''">
				oname=#{oname},
		     </if>
	         <if test="proxy!=null and proxy!=''">
				proxy=#{proxy},
		     </if>
		     <if test="link!=null and link!=''">
				link=#{link},
		     </if>
		     <if test="summary!=null and summary!=''">
				summary=#{summary},
		     </if>
		     update_time=now() where id=#{id}
	</update>
	
	<select id="list" resultType="organization">
	   select id,oname,proxy,summary,link,create_time,update_time from organization
	    <include refid="listSql"></include>
		order by update_time desc
		limit #{beginNum},#{onePageSize}
	</select>
	
	<select id="count" resultType="int">
	    select count(1) from organization 
	    <include refid="listSql"></include>
	</select>
	
	<select id="selectByIds" resultType="organization">
	      select id,oname,link,summary,proxy,create_time,update_time from organization 
          <where>
            <if test="ids!=null and ids.size()>0">
		        id in
		        <foreach collection="ids" index="index" item="item" open="(" separator="," close=")">  
                 #{item}  
                </foreach>
            </if>
          </where>
	</select>
	
	<sql id="listSql">
	         where 1=1
	         <if test="proxy!=null and proxy!=''">
				and proxy=#{proxy}
		     </if>
	         <if test="oname!=null and oname!=''">
				and oname LIKE concat(concat('%',#{oname}),'%')
		     </if>
	</sql>
</mapper>
